<div class="container my-5">
  <div class="row justify-content-center">
    <div class="col-12 col-lg-8">
      <div class="card shadow-lg border-0">


        <div class="card-header bg-info text-white text-center">
          <h2>Registro de Nuevo Examen</h2>
          <p class="mb-0">Completa los datos para solicitar un nuevo an치lisis.</p>
        </div>


        <div class="card-body p-4">
          <form [formGroup]="examenForm" (ngSubmit)="onSubmit()">


            <h4 class="text-primary mb-3">Datos del Paciente</h4>
            <div class="row mb-3">
              <div class="col-md-6">
                <label class="form-label">Nombre Completo</label>
                <input type="text" class="form-control"
                       formControlName="pacienteNombre"
                       [class.is-invalid]="isInvalid('pacienteNombre')">
              </div>

              <div class="col-md-6">
                <label class="form-label">RUT</label>
                <input type="text" class="form-control"
                       formControlName="pacienteRut"
                       [class.is-invalid]="isInvalid('pacienteRut')">
              </div>
            </div>


            <h4 class="text-primary mt-4 mb-3">Detalles del An치lisis</h4>
            <div class="row mb-3">

              <div class="col-md-6">
                <label class="form-label">Tipo de An치lisis</label>
                <select class="form-select"
                        formControlName="tipoAnalisis"
                        [class.is-invalid]="isInvalid('tipoAnalisis')">
                  <option value="">Seleccione un an치lisis</option>
                  <option *ngFor="let tipo of tiposAnalisis" [value]="tipo">
                    {{ tipo }}
                  </option>
                </select>
              </div>


              <div class="col-md-6">
                <label class="form-label">Laboratorio Destino</label>


                <ng-container *ngIf="!loadingLabs; else cargandoLabs">
                  <select class="form-select"
                          formControlName="laboratorio"
                          [class.is-invalid]="isInvalid('laboratorio')">
                    <option value="">Seleccione un laboratorio</option>
                    <option *ngFor="let lab of laboratorios" [value]="lab.id">
                      {{ lab.nombre }}
                    </option>
                  </select>
                </ng-container>


                <ng-template #cargandoLabs>
                  <p class="text-muted">Cargando laboratorios...</p>
                </ng-template>
              </div>
            </div>


            <div class="row mb-3">
              <div class="col-md-6">
                <label class="form-label">Fecha de Solicitud</label>
                <input type="date"
                       class="form-control"
                       formControlName="fechaSolicitud"
                       [min]="today"
                       [class.is-invalid]="isInvalid('fechaSolicitud')">
              </div>

              <div class="col-md-6">
                <label class="form-label">Estado</label>
                <input type="text"
                       class="form-control bg-light"
                       formControlName="estado"
                       readonly>
              </div>
            </div>

            <div class="mb-4">
              <label class="form-label">Observaciones</label>
              <textarea class="form-control"
                        rows="3"
                        formControlName="observaciones"></textarea>
            </div>


            <div class="d-grid">
              <button class="btn btn-info btn-lg text-white"
                      type="submit"
                      [disabled]="examenForm.invalid || loadingLabs">
                Registrar Examen
              </button>
            </div>

          </form>
        </div>

      </div>
    </div>
  </div>
</div>
